<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ATMOS ‚Äî Timeline 2025</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      /* ATMOS design tokens */
      --primary:#00eaff;       /* cyan n√©on */
      --accent:#8a2be2;        /* violet n√©on */
      --text:#e6f7ff;          
      --muted:#9fb3c8;
      --bg-a:#05060d;
      --bg-b:#0b1430;
      --bg-c:#00182a;
      --ring: drop-shadow(0 0 8px rgba(0,234,255,.55)) drop-shadow(0 0 18px rgba(138,43,226,.35));
      --month: 8.333333%;
    }

    /* --- Page reset --- */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Outfit", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color:var(--text);
      background: radial-gradient(1200px 800px at 80% -10%, rgba(0,234,255,.08), transparent 60%),
                  radial-gradient(900px 700px at -10% 30%, rgba(138,43,226,.08), transparent 50%),
                  linear-gradient(180deg, var(--bg-a), var(--bg-b) 40%, var(--bg-c));
      background-attachment: fixed;
      overflow-x:hidden;
    }

    /* --- Subtle starfield --- */
    .stars, .stars::before, .stars::after{
      position:fixed; inset:0; pointer-events:none; z-index:0;
      background-image: radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.7) 40%, transparent 42%),
                        radial-gradient(1px 1px at 60% 70%, rgba(255,255,255,.5) 40%, transparent 42%),
                        radial-gradient(1.5px 1.5px at 80% 20%, rgba(255,255,255,.5) 40%, transparent 42%),
                        radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,.5) 40%, transparent 42%);
      opacity:.3; filter:blur(.2px);
    }
    .stars::before{content:""; animation: twinkle 8s linear infinite; opacity:.25}
    .stars::after {content:""; animation: twinkle 13s linear infinite reverse; opacity:.25}
    @keyframes twinkle{0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)}}

    /* --- Header / hero --- */
    header.hero{ position:relative; z-index:1; padding:48px 20px 24px; text-align:center; }
    .brand{font-family:"Orbitron", sans-serif; letter-spacing:.06em; font-weight:800; font-size:14px; color:var(--muted); text-transform:uppercase}
    h1{ margin:.25rem auto .5rem; max-width:900px; font-family:"Orbitron", sans-serif; font-size:clamp(28px, 4.6vw, 54px); font-weight:900; line-height:1.02; text-shadow:0 0 6px rgba(0,234,255,.35), 0 0 18px rgba(138,43,226,.25); }
    h1 .grad{background:linear-gradient(92deg, var(--primary), var(--accent)); -webkit-background-clip:text; background-clip:text; color:transparent;}
    .lead{max-width:840px; margin:0 auto; color:var(--muted)}

    /* --- Controls --- */
    .controls{
      position:sticky; top:0; z-index:3;
      display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center;
      padding:12px 16px; margin:20px auto 0; backdrop-filter:blur(8px);
      background:linear-gradient(180deg, rgba(5,6,13,.72), rgba(5,6,13,.35));
      border:1px solid rgba(255,255,255,.06); border-radius:16px; width:min(1100px, 92%);
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .chip{ --o:.35; display:inline-flex; align-items:center; gap:.5ch; cursor:pointer; user-select:none;
      padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,.08);
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
      color:var(--text); font-size:14px; transition:.2s ease; filter:var(--ring);
    }
    .chip[data-active="true"]{ border-color:rgba(0,234,255,.55); box-shadow:0 0 0 2px rgba(0,234,255,.12) inset }
    .chip .dot{width:8px; height:8px; border-radius:50%; background:var(--primary); box-shadow:0 0 10px rgba(0,234,255,.7)}
    .chip[data-cat="partenariat"] .dot{background:#00ff9c}
    .chip[data-cat="marketing"]   .dot{background:#ffd166}
    .chip[data-cat="release"]      .dot{background:#ff6b6b}
    .chip[data-cat="evenement"]    .dot{background:#8a2be2}
    .chip[data-cat="ops"]          .dot{background:#5bd3ff}
    .chip[data-cat="contenu"]      .dot{background:#c5ff61}

    .spacer{flex:1 1 12px}
    .months{display:flex; gap:6px; flex-wrap:wrap}
    .months button{all:unset; cursor:pointer; padding:8px 10px; font-size:12px; color:var(--muted); border-radius:10px; border:1px solid rgba(255,255,255,.08)}
    .months button:hover{color:var(--text); border-color:rgba(255,255,255,.16)}

    .meter{display:flex; align-items:center; gap:8px; color:var(--muted); font-size:12px}
    .bar{position:relative; width:160px; height:7px; border-radius:999px; background:rgba(255,255,255,.08); overflow:hidden}
    .bar>i{position:absolute; inset:0; width:var(--p,0%); background:linear-gradient(90deg, var(--primary), var(--accent)); box-shadow:0 0 18px rgba(0,234,255,.35)}

    .view{display:flex; gap:10px; border-left:1px solid rgba(255,255,255,.08); padding-left:10px}

    /* --- Shell --- */
    .wrap{position:relative; z-index:1; width:min(1200px, 92%); margin:28px auto 80px}

    /* ---------- VUE 1 : Timeline verticale (existante) ---------- */
    body.view-vertical #timelineVertical{display:block}
    body.view-vertical #roadmapHoriz{display:none}
    body.view-roadmap #timelineVertical{display:none}
    body.view-roadmap #roadmapHoriz{display:block}

    .timeline{ position:relative; padding:40px 0; margin:0 auto; }
    .timeline::before{ content:""; position:absolute; left:50%; top:0; bottom:0; width:4px; transform:translateX(-50%);
      background:linear-gradient(180deg, rgba(0,234,255,.0), rgba(0,234,255,.7) 15%, rgba(138,43,226,.7) 85%, rgba(138,43,226,.0));
      filter:drop-shadow(0 0 10px rgba(0,234,255,.35)); }

    .month{ position:relative; margin:36px 0 16px; scroll-margin-top:90px; }
    .month h2{ display:inline-flex; align-items:center; gap:10px; font-family:"Orbitron", sans-serif; font-weight:800;
      font-size:18px; letter-spacing:.06em; text-transform:uppercase; color:var(--muted);
      background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); border-radius:999px; padding:6px 12px; }
    .month.is-today h2{color:var(--text); border-color:rgba(0,234,255,.35); box-shadow:0 0 0 2px rgba(0,234,255,.15) inset}

    .item{position:relative; display:grid; grid-template-columns: 1fr 1fr; gap:28px; margin:18px 0}
    .item:nth-child(odd) .card{grid-column:1}
    .item:nth-child(odd) .node{left:calc(50% - 10px)}
    .item:nth-child(even) .card{grid-column:2}
    .item:nth-child(even) .node{left:calc(50% - 10px)}

    .node{position:absolute; top:18px; width:20px; height:20px; border-radius:50%; background:var(--bg-c);
      border:2px solid var(--primary); box-shadow:0 0 18px rgba(0,234,255,.55), inset 0 0 18px rgba(0,234,255,.25); filter:var(--ring)}

    .card{ position:relative; padding:16px 18px 16px 16px; border-radius:16px; overflow:hidden;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08);
      box-shadow:0 10px 30px rgba(0,0,0,.25); transition:transform .2s ease, border-color .2s ease; }
    .card::before{content:""; position:absolute; inset:-1px; border-radius:16px; padding:1px;
      background:linear-gradient(140deg, rgba(0,234,255,.5), rgba(138,43,226,.35)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor; mask-composite: exclude; opacity:.25}
    .card:hover{transform:translateY(-2px); border-color:rgba(0,234,255,.2)}

    .card .top{display:flex; align-items:center; gap:12px; margin-bottom:8px}
    .icon{width:28px; height:28px; border-radius:8px; display:grid; place-items:center; font-size:16px; filter:var(--ring);
      background:linear-gradient(120deg, rgba(0,234,255,.14), rgba(138,43,226,.14)); border:1px solid rgba(255,255,255,.12)}
    .title{font-weight:700; color:var(--text)}
    .meta{display:flex; flex-wrap:wrap; gap:8px; align-items:center; color:var(--muted); font-size:12px}

    .badge{font-size:11px; padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.14); color:var(--text)}
    .badge[data-cat="partenariat"]{background:rgba(0,255,156,.12); border-color:rgba(0,255,156,.35)}
    .badge[data-cat="marketing"]  {background:rgba(255,209,102,.12); border-color:rgba(255,209,102,.35)}
    .badge[data-cat="release"]     {background:rgba(255,107,107,.12); border-color:rgba(255,107,107,.35)}
    .badge[data-cat="evenement"]   {background:rgba(138,43,226,.12); border-color:rgba(138,43,226,.35)}
    .badge[data-cat="ops"]         {background:rgba(91,211,255,.12); border-color:rgba(91,211,255,.35)}
    .badge[data-cat="contenu"]     {background:rgba(197,255,97,.12); border-color:rgba(197,255,97,.35)}

    .desc{margin-top:8px; color:var(--text); opacity:.85; line-height:1.5}
    .ribbon{position:absolute; top:8px; right:-36px; transform:rotate(35deg); background:linear-gradient(90deg, var(--primary), var(--accent)); color:#001018;
      padding:4px 48px; font-size:12px; font-weight:800; letter-spacing:.08em; text-transform:uppercase; box-shadow:0 0 18px rgba(0,234,255,.45)}

    /* Responsive for vertical */
    @media (max-width:900px){
      .item{grid-template-columns:1fr;}
      .timeline::before{left:24px; transform:none}
      .node{left:14px}
      .card{margin-left:52px}
    }

    /* ---------- VUE 2 : Roadmap horizontale en swimlanes ---------- */
    .roadwrap{ width:min(1400px, 95%); margin:0 auto; }
    .roadscroll{ position:relative; overflow-x:auto; overflow-y:hidden; border:1px solid rgba(255,255,255,.08); border-radius:16px; backdrop-filter:blur(6px);
      background:
        repeating-linear-gradient(to right, rgba(255,255,255,.08) 0 1px, transparent 1px calc(var(--month)), transparent calc(var(--month)) calc(2*var(--month))),
        linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .roadmap{ position:relative; min-width:1200px; height:auto; padding-top:48px; }

    /* Axe des mois (sticky) */
    .axis{ position:sticky; top:0; z-index:2; height:36px; display:flex; align-items:center; gap:0; background:linear-gradient(180deg, rgba(5,6,13,.75), rgba(5,6,13,.35));
      border-bottom:1px solid rgba(255,255,255,.08); }
    .axis .tick{ position:relative; width:calc(var(--month)); text-align:center; font-size:12px; color:var(--muted); padding:6px 0; }
    .axis .tick::after{ content:""; position:absolute; right:0; top:0; bottom:0; width:1px; background:rgba(255,255,255,.08) }

    /* Lignes (swimlanes) */
    .lanes{ position:relative; }
    .lane{ position:relative; height:74px; border-bottom:1px dashed rgba(255,255,255,.08); }
    .lane.is-dim{ opacity:.35; filter:saturate(.6) }

    /* Libell√© de ligne (collant √† gauche dans la zone scroll) */
    .lane .label{ position:sticky; left:0; z-index:1; height:100%; display:flex; align-items:center; gap:10px; padding:0 12px; width:210px;
      background:linear-gradient(90deg, rgba(5,6,13,.85), rgba(5,6,13,.0)); border-right:1px solid rgba(255,255,255,.08);
      font-size:13px; text-transform:capitalize; color:var(--text); }
    .lane .label .dot{ width:10px; height:10px; border-radius:50%; box-shadow:0 0 10px currentColor }
    .lane[data-cat="partenariat"] .label .dot{ color:#00ff9c }
    .lane[data-cat="marketing"] .label .dot{ color:#ffd166 }
    .lane[data-cat="release"] .label .dot{ color:#ff6b6b }
    .lane[data-cat="evenement"] .label .dot{ color:#8a2be2 }
    .lane[data-cat="ops"] .label .dot{ color:#5bd3ff }
    .lane[data-cat="contenu"] .label .dot{ color:#c5ff61 }

    /* Zone des events (bars) */
    .lane .bars{ position:relative; height:100%; margin-left:210px; }
    .barItem{ position:absolute; top:16px; height:42px; min-width:32px; padding:8px 10px; border-radius:10px; display:flex; align-items:center; gap:8px;
      background:linear-gradient(120deg, rgba(0,234,255,.12), rgba(138,43,226,.12)); border:1px solid rgba(255,255,255,.18);
      box-shadow:0 8px 20px rgba(0,0,0,.25), 0 0 14px rgba(0,234,255,.15); backdrop-filter:blur(3px); white-space:nowrap; transform:translateZ(0);
      will-change:transform; }
    .barItem .ic{ font-size:14px }
    .barItem .t{ font-weight:700; font-size:13px }
    .barItem .d{ font-size:12px; color:var(--muted) }

    /* Ligne verticale "Aujourd'hui" */
    .todayLine{ position:absolute; top:36px; bottom:0; width:2px; background:linear-gradient(180deg, var(--primary), var(--accent)); box-shadow:0 0 14px rgba(0,234,255,.35); }

    /* Tooltip simple */
    .barItem[data-hint]:hover::after{
      content:attr(data-hint); position:absolute; left:0; bottom:calc(100% + 8px); max-width:320px;
      background:rgba(0,8,14,.95); border:1px solid rgba(255,255,255,.15); padding:8px 10px; border-radius:8px; font-size:12px; color:var(--text);
      box-shadow:0 6px 18px rgba(0,0,0,.35);
    }

    /* Footer */
    footer{color:var(--muted); text-align:center; margin:60px 0 50px}
  </style>
</head>
<body class="view-roadmap">
  <div class="stars"></div>

  <header class="hero">
    <div class="brand">ATMOS ‚Äî Demo UI</div>
    <h1>Timeline <span class="grad">2025</span></h1>
    <p class="lead">Deux pr√©sentations compl√©mentaires : <strong>Verticale</strong> (classique) et <strong>Roadmap horizontale en swimlanes</strong>. Ann√©e du <strong>1er janvier 2025</strong> au <strong>31 d√©cembre 2025</strong>.</p>

    <div class="controls" role="region" aria-label="Filtres et navigation">
      <button class="chip" data-cat="tous" data-active="true"><span class="dot"></span> Tous</button>
      <button class="chip" data-cat="release"><span class="dot"></span> Releases</button>
      <button class="chip" data-cat="partenariat"><span class="dot"></span> Partenariats</button>
      <button class="chip" data-cat="marketing"><span class="dot"></span> Marketing</button>
      <button class="chip" data-cat="evenement"><span class="dot"></span> √âv√©nements</button>
      <button class="chip" data-cat="ops"><span class="dot"></span> Ops</button>
      <button class="chip" data-cat="contenu"><span class="dot"></span> Contenu</button>

      <span class="spacer"></span>

      <div class="months" aria-label="Aller au mois">
        <button data-go="01">Jan</button>
        <button data-go="02">F√©v</button>
        <button data-go="03">Mar</button>
        <button data-go="04">Avr</button>
        <button data-go="05">Mai</button>
        <button data-go="06">Juin</button>
        <button data-go="07">Juil</button>
        <button data-go="08">Ao√ªt</button>
        <button data-go="09">Sep</button>
        <button data-go="10">Oct</button>
        <button data-go="11">Nov</button>
        <button data-go="12">D√©c</button>
      </div>

      <div class="meter" title="Progression de l'ann√©e 2025">
        <span>Progression</span>
        <div class="bar"><i id="yearProgress"></i></div>
        <span id="yearPct">0%</span>
      </div>

      <div class="view" aria-label="Changer de vue">
        <button class="chip chip-view" data-view="vertical"><span class="dot"></span> Vue verticale</button>
        <button class="chip chip-view" data-view="roadmap" data-active="true"><span class="dot"></span> Vue roadmap</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- Vue 1: verticale -->
    <section id="timelineVertical" class="timeline" aria-label="Timeline 2025 (vertical)"></section>

    <!-- Vue 2: roadmap horizontale -->
    <section id="roadmapHoriz" class="roadwrap" aria-label="Timeline 2025 (roadmap)">
      <div class="roadscroll" id="roadscroll">
        <div class="axis" id="axis"></div>
        <div class="roadmap" id="roadmap">
          <div class="lanes" id="lanes"></div>
          <!-- Ligne "Aujourd'hui" -->
          <div class="todayLine" id="todayLine" hidden></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    D√©monstration visuelle ‚Ä¢ Style inspir√© d'<strong>ATMOS</strong> (typographie Orbitron/Outfit, n√©ons cyan/violet, fond spatial). Deux vues performantes et compl√©mentaires.
  </footer>

  <script>
    // --- Data (fictive) ---
    const EVENTS = [
      {date:'2025-01-05', title:'Lancement ORIS v2', cat:'release', icon:'üóìÔ∏è', desc:"Nouvelle architecture d'agenda avec synchronisation et vues rapides."},
      {date:'2025-01-20', title:'Partenariat Abby Connect', cat:'partenariat', icon:'ü§ù', desc:"Accord de distribution r√©ciproque et offre bienvenue pour les pros."},

      {date:'2025-02-10', title:'Campagne Google Ads pilote', cat:'marketing', icon:'üéØ', desc:"Tests A/B sur mots-cl√©s SAP et optimisation des conversions."},
      {date:'2025-02-27', title:'SPHAIRA v1.1', cat:'release', icon:'üåÄ', desc:"Noeuds reli√©s + menu contextuel revu + meilleure performance."},

      {date:'2025-03-12', title:'S√©rie d‚Äôarticles SEO', cat:'contenu', icon:'‚úçÔ∏è', desc:"Guide complet: d√©claration SAP, agr√©ment, avance imm√©diate."},
      {date:'2025-03-28', title:'D√©mo publique ATMOS', cat:'evenement', icon:'üöÄ', desc:"Pr√©sentation live du hub et des modules, session Q&R."},

      {date:'2025-04-04', title:'Partenariat D√©clic+', cat:'partenariat', icon:'ü§ù', desc:"Offre sp√©ciale d‚Äôadh√©sion simplifi√©e pour les nouveaux pros."},
      {date:'2025-04-18', title:'Support CESU Pr√©financ√©', cat:'ops', icon:'üí≥', desc:"Ajout de l‚Äôacceptation CESU pour plusieurs partenaires."},

      {date:'2025-05-09', title:'Salon Tech Grenoble', cat:'evenement', icon:'üé™', desc:"Petit stand, d√©monstrations et retours terrain utilisateurs."},
      {date:'2025-05-26', title:'Capsule vid√©o ‚ÄúAvance imm√©diate‚Äù', cat:'marketing', icon:'üé¨', desc:"Vid√©o courte d‚Äôinformation √† diffuser sur TikTok/LinkedIn."},

      {date:'2025-06-07', title:'Refonte du comparatif', cat:'ops', icon:'üìä', desc:"Mise √† jour des frais et services + nouveau tri intelligent."},
      {date:'2025-06-24', title:'Int√©gration Google Calendar', cat:'release', icon:'üîó', desc:"Connexion fluide dans ORIS, synchro bidirectionnelle."},

      {date:'2025-07-01', title:'NEXUS ‚Äî affichage vertical', cat:'release', icon:'üìß', desc:"Lecture mails pleine largeur, pi√®ces jointes, actions rapides."},
      {date:'2025-07-22', title:'Audit RGPD interne', cat:'ops', icon:'üõ°Ô∏è', desc:"Cartographie des traitements et registre √† jour."},

      {date:'2025-08-05', title:'√âtude de march√© Suisse', cat:'contenu', icon:'üß≠', desc:"Analyse prix, TVA et attentes clients pour services √† domicile."},
      {date:'2025-08-22', title:'Partenariat France SAP', cat:'partenariat', icon:'ü§ù', desc:"Synergies contenus + offres crois√©es pour les pros."},

      {date:'2025-09-10', title:'SPHAIRA Node Editor v2', cat:'release', icon:'üß©', desc:"Objectifs li√©s aux t√¢ches + liaisons conditionnelles."},
      {date:'2025-09-25', title:'Beta assistants vocaux', cat:'evenement', icon:'üó£Ô∏è', desc:"Prototype robot-enceinte r√©pondant via API et TTS."},

      {date:'2025-10-08', title:'Webinaire ‚ÄúSAP 101‚Äù', cat:'evenement', icon:'üì°', desc:"Cr√©dit d‚Äôimp√¥t, d√©claration, avance imm√©diate ‚Äî session live."},
      {date:'2025-10-21', title:'Campagne emailing pro', cat:'marketing', icon:'‚úâÔ∏è', desc:"Relance des leads inactifs et nurturing par secteur."},

      {date:'2025-11-04', title:'Diagnostic Pro‚ÄëSAP (lancement)', cat:'release', icon:'üß™', desc:"Assistant d‚Äôauto‚Äë√©valuation avec recommandations actionnables."},
      {date:'2025-11-18', title:'Migration h√©bergement', cat:'ops', icon:'üóÑÔ∏è', desc:"Am√©lioration de la r√©silience et CDN multi‚Äër√©gion."},

      {date:'2025-12-05', title:'Bilan & KPI 2025', cat:'contenu', icon:'üìà', desc:"Synth√®se CA, trafic, acquisitions, satisfaction partenaires."},
      {date:'2025-12-20', title:'Soir√©e partenaires', cat:'evenement', icon:'üéâ', desc:"R√©trospective, prix symboliques et feuille de route 2026."}
    ];

    // --- Helpers & constants ---
    const start = new Date('2025-01-01T00:00:00');
    const end   = new Date('2025-12-31T23:59:59');
    const isYear2025 = new Date().getFullYear() === 2025;

    function fmtDate(d){
      return new Intl.DateTimeFormat('fr-FR', { day:'2-digit', month:'short' }).format(d).replace('.', '');
    }
    function pctOfYear(d){ return ((d - start) / (end - start)) * 100 }

    function groupByMonth(items){
      const map = new Map(Array.from({length:12}, (_,i)=>[(i+1).toString().padStart(2,'0'), []]));
      for(const ev of items){ const d = new Date(ev.date); const m = (d.getMonth()+1).toString().padStart(2,'0'); map.get(m).push({...ev, d}); }
      for(const [m, arr] of map) arr.sort((a,b)=>a.d-b.d);
      return map;
    }

    function groupByCat(items){
      const cats = ['release','partenariat','marketing','evenement','ops','contenu'];
      const map = new Map(cats.map(c=>[c,[]]));
      for(const ev of items){ const d = new Date(ev.date); if(map.has(ev.cat)) map.get(ev.cat).push({...ev, d}); }
      for(const [c, arr] of map) arr.sort((a,b)=>a.d-b.d);
      return map;
    }

    // ---------- Rendu : VUE VERTICALE ----------
    function renderVertical(){
      const container = document.getElementById('timelineVertical');
      const byMonth = groupByMonth(EVENTS);
      const today = new Date();
      const todayKey = isYear2025 ? (today.getMonth()+1).toString().padStart(2,'0') : null;

      container.innerHTML = '';
      for(let i=1;i<=12;i++){
        const key = i.toString().padStart(2,'0');
        const section = document.createElement('section'); section.className = 'month' + (todayKey===key? ' is-today':'' ); section.id = `m${key}`;
        const h = document.createElement('h2'); h.textContent = new Date(`2025-${key}-01`).toLocaleDateString('fr-FR', {month:'long'});
        section.appendChild(h);

        const monthEvents = byMonth.get(key);
        if(monthEvents.length===0){
          const empty = document.createElement('div'); empty.className = 'item'; empty.innerHTML = `<span class="node" aria-hidden="true"></span><div class="card"><div class="meta">Aucun √©v√®nement</div></div>`; section.appendChild(empty);
        } else {
          monthEvents.forEach(ev=>{
            const item = document.createElement('article'); item.className = 'item'; item.dataset.cat = ev.cat;
            const isToday = isYear2025 && ev.d.toDateString()===today.toDateString();
            item.innerHTML = `
              <span class="node" aria-hidden="true"></span>
              <div class="card" role="group" aria-label="${ev.title}">
                ${isToday?'<div class="ribbon">Aujourd\'hui</div>':''}
                <div class="top">
                  <div class="icon">${ev.icon}</div>
                  <div>
                    <div class="title">${ev.title}</div>
                    <div class="meta">
                      <span>${fmtDate(ev.d)}</span>
                      <span class="badge" data-cat="${ev.cat}">${ev.cat}</span>
                    </div>
                  </div>
                </div>
                <div class="desc">${ev.desc}</div>
              </div>`;
            section.appendChild(item);
          });
        }
        container.appendChild(section);
      }
    }

    // ---------- Rendu : VUE ROADMAP (horizontale) ----------
    function renderRoadmap(){
      const axis = document.getElementById('axis');
      const lanesWrap = document.getElementById('lanes');
      const todayLine = document.getElementById('todayLine');

      // Axe des mois
      axis.innerHTML = '';
      for(let i=0; i<12; i++){
        const m = document.createElement('div'); m.className='tick'; m.style.width='calc(var(--month))';
        m.textContent = new Date(2025, i, 1).toLocaleDateString('fr-FR', {month:'short'}).replace('.', '');
        axis.appendChild(m);
      }

      // Lanes par cat√©gorie
      lanesWrap.innerHTML = '';
      const byCat = groupByCat(EVENTS);
      for(const [cat, arr] of byCat){
        const lane = document.createElement('div'); lane.className='lane'; lane.dataset.cat = cat;
        const label = document.createElement('div'); label.className='label'; label.innerHTML = `<span class="dot"></span> ${cat}`;
        const bars = document.createElement('div'); bars.className='bars';

        arr.forEach(ev=>{
          const left = pctOfYear(ev.d);
          const widthPct = 1.6; // largeur approx ~6 jours
          const bar = document.createElement('div'); bar.className='barItem'; bar.dataset.cat = ev.cat;
          bar.style.left = `calc(${left}% - 80px)`; // petit offset visuel
          bar.style.width = `max(${widthPct}%, 120px)`; // lisible sur petits √©crans
          bar.setAttribute('data-hint', `${fmtDate(ev.d)} ‚Äî ${ev.title}`);
          bar.innerHTML = `<span class="ic">${ev.icon}</span><span class="t">${ev.title}</span><span class="d">‚Ä¢ ${fmtDate(ev.d)}</span>`;
          bars.appendChild(bar);
        });

        lane.appendChild(label); lane.appendChild(bars); lanesWrap.appendChild(lane);
      }

      // Ligne aujourd'hui
      if(isYear2025){
        const p = pctOfYear(new Date());
        todayLine.style.left = `calc(${p}% + 210px)`; // tenir compte du label collant
        todayLine.hidden = false;
      } else {
        todayLine.hidden = true;
      }
    }

    // --- Filters (appliqu√©s aux deux vues) ---
    function applyFilter(cat){
      // Verticale
      document.querySelectorAll('#timelineVertical .item').forEach(it=>{
        it.style.display = (cat==='tous' || it.dataset.cat===cat) ? '' : 'none';
      });
      // Roadmap
      document.querySelectorAll('#lanes .lane').forEach(l=>{
        const match = l.dataset.cat === cat;
        l.classList.toggle('is-dim', !(cat==='tous' || match));
        l.style.display = (cat==='tous' || match) ? '' : '';
        l.querySelectorAll('.barItem').forEach(b=>{
          b.style.opacity = (cat==='tous' || b.dataset.cat===cat) ? 1 : .15;
        });
      });
    }

    // --- Month jump (scroll vertical OU horizontal) ---
    function attachMonthNav(){
      document.querySelectorAll('.months button').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.dataset.go;
          if(document.body.classList.contains('view-vertical')){
            document.getElementById(`m${key}`)?.scrollIntoView({behavior:'smooth', block:'start'});
          } else {
            const scroll = document.getElementById('roadscroll');
            const ratio = (parseInt(key,10)-1) / 12; // 0..1
            const target = ratio * (scroll.scrollWidth - scroll.clientWidth);
            scroll.scrollTo({left: Math.max(0, target), behavior:'smooth'});
          }
        });
      });
    }

    // --- Progression ann√©e ---
    function setYearProgress(){
      const now = new Date();
      let pct = 0;
      if(now < start) pct = 0; else if(now > end) pct = 100; else pct = ((now - start) / (end - start)) * 100;
      document.getElementById('yearProgress').style.setProperty('--p', pct.toFixed(2) + '%');
      document.getElementById('yearPct').textContent = Math.round(pct) + '%';
    }

    // --- View switch ---
    function attachViewSwitch(){
      const chips = document.querySelectorAll('.chip-view');
      chips.forEach(ch=>{
        ch.addEventListener('click', ()=>{
          chips.forEach(c=>c.dataset.active='false');
          ch.dataset.active='true';
          const view = ch.dataset.view; // 'vertical' | 'roadmap'
          document.body.classList.toggle('view-vertical', view==='vertical');
          document.body.classList.toggle('view-roadmap', view==='roadmap');
        });
      });
    }

    // --- Cat filter controls ---
    function attachFilters(){
      const chips = [...document.querySelectorAll('.controls > .chip')].filter(x=>!x.classList.contains('chip-view'));
      chips.forEach(ch=>{
        ch.addEventListener('click', ()=>{
          chips.forEach(c=>c.dataset.active='false');
          ch.dataset.active='true';
          applyFilter(ch.dataset.cat);
        });
      });
    }

    // Init
    renderVertical();
    renderRoadmap();
    attachFilters();
    attachMonthNav();
    attachViewSwitch();
    setYearProgress();
    setInterval(setYearProgress, 60*60*1000);
  </script>
</body>
</html>
